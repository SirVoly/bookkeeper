import (
	"context"
	"database/sql"
	"log"

	"github.com/SirVoly/bookkeeper/internal/database"
	"github.com/google/uuid"
	_ "modernc.org/sqlite"
)

func main() {
	ctx := context.Background()

	db, err := sql.Open("sqlite", "bookkeeper.db")
	if err != nil {
		log.Fatalf("error opening database: %v", err)
	}

	queries := database.New(db)
	listBooks(ctx, *queries)
}

func listBooks(ctx context.Context, queries database.Queries) {
	books, err := queries.ListBooks(ctx)
	if err != nil {
		log.Fatalf("error listing books: %v", err)
	}
	log.Println(books)
}

func createBook(ctx context.Context, queries database.Queries) {
	book, err := queries.CreateBook(ctx, database.CreateBookParams{
		ID:              uuid.NewString(),
		Title:           "Heroes",
		Isbn:            9780718188726,
		PublicationDate: sql.NullString{String: "November 2, 2017", Valid: true},
		NumberOfPages:   sql.NullInt64{Int64: 416, Valid: true},
	})
	if err != nil {
		log.Fatalf("error creating book: %v", err)
	}
	log.Println(book)
}
